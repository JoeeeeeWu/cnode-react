webpackJsonp([4,7],{339:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),u=a(c),s=n(225),f=n(340),p=a(f),d=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){return u.default.createElement("p",{className:p.default.warn},"您还没登录，",u.default.createElement(s.Link,{to:"/login"},"点击登录"),"！")}}]),t}(c.Component);t.default=d},340:function(e,t,n){var a=n(341);"string"==typeof a&&(a=[[e.id,a,""]]);n(283)(a,{});a.locals&&(e.exports=a.locals)},341:function(e,t,n){t=e.exports=n(282)(),t.push([e.id,".LoginWarn__warn-3cBJX{text-align:center;padding-top:.5rem;padding-bottom:.5rem}",""]),t.locals={warn:"LoginWarn__warn-3cBJX"}},342:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),u=a(c),s=n(343),f=a(s),p=n(296),d=a(p),m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.left,a=e.right,r=e.leftClick,o=e.rightClick,i=n?"btnActive":null,l=a?"btnActive":null;return u.default.createElement(d.default,{transitionName:"down",transitionAppear:!0,transitionAppearTimeout:200,transitionEnterTimeout:200,transitionLeaveTimeout:200},u.default.createElement("header",{className:f.default.header,key:"header"},u.default.createElement("div",{className:f.default.left+" "+f.default[i],onClick:r},n),u.default.createElement("h2",{className:f.default.title},t),u.default.createElement("div",{className:f.default.right+" "+f.default[l],onClick:o},a)))}}]),t}(c.Component);t.default=m},343:function(e,t,n){var a=n(344);"string"==typeof a&&(a=[[e.id,a,""]]);n(283)(a,{});a.locals&&(e.exports=a.locals)},344:function(e,t,n){t=e.exports=n(282)(),t.push([e.id,".header__header-P1JXb{height:.4rem;line-height:.4rem;background-color:#383b45;color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;text-align:center}.header__header-P1JXb .iconfont{color:#383b45}.header__left-1LJ0R,.header__right-OV-TJ{width:.4rem;height:.4rem;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.header__btnActive-1M7qR{background-color:#66b32f}.header__title-2UExb{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}",""]),t.locals={header:"header__header-P1JXb",left:"header__left-1LJ0R",right:"header__right-OV-TJ",btnActive:"header__btnActive-1M7qR",title:"header__title-2UExb"}},364:function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(1),s=r(u),f=n(178),p=n(225),d=n(365),m=a(d),_=n(342),h=r(_),b=n(366),y=r(b),g=n(370),v=r(g),w=n(339),E=r(w),x=n(291),k=a(x),O=n(334),T=r(O),j=n(293),C=r(j),N=n(296),P=r(N),D=n(309),R=r(D),S=n(373),M=r(S),I="https://cnodejs.org/api/v1/",L=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!0,msg:"正在加载中！"},n.getTopicData=n.getTopicData.bind(n),n}return l(t,e),c(t,[{key:"componentWillMount",value:function(){var e=this.props.params.id,t=this.props.renderTopic;document.body.scrollTop=0,this.getTopicData(t,e)}},{key:"getTopicData",value:function(e,t){var n=this;R.default.get(I+"topic/"+t,{params:{data:(new Date).getTime()}}).then(function(t){e(t.data.data),n.setState({show:!1})}).catch(function(e){console.log(e),n.setState({msg:"加载失败！"})})}},{key:"render",value:function(){var e=this.props.topicData,t=e.title,n=e.tab,a=e.author,r=e.create_at,o=e.visit_count,i=e.reply_count,l=e.content,c=e.replies,u=a.loginname,f=a.avatar_url,d=s.default.createElement("i",{className:"iconfont icon-back"}),m=p.hashHistory.goBack,_=localStorage.getItem("accesstoken");return s.default.createElement("div",null,s.default.createElement("div",{className:M.default.headerContainer},s.default.createElement(h.default,{title:"详情",left:d,leftClick:m})),s.default.createElement("div",{className:M.default.topicContainer},this.state.show?s.default.createElement(C.default,{msg:this.state.msg}):s.default.createElement(P.default,{transitionName:"fade",transitionAppear:!0,transitionAppearTimeout:500,transitionEnterTimeout:500,transitionLeaveTimeout:500},s.default.createElement("div",{className:M.default.topic,key:"topic"},s.default.createElement("h3",{className:M.default.title},s.default.createElement("i",{className:"iconfont icon-"+n}),t),s.default.createElement("div",{className:M.default.msg},s.default.createElement("div",{className:M.default.pic},s.default.createElement(p.Link,{to:"/user/"+u},s.default.createElement("img",{src:f,className:M.default.avatar}))),s.default.createElement("div",{className:M.default.msgDetail},s.default.createElement("div",null,s.default.createElement(p.Link,{to:"/user/"+u},s.default.createElement("span",null,u)),s.default.createElement("span",null,"发表于",k.formatTime(r))),s.default.createElement("div",null,s.default.createElement("span",null,"阅读：",o),s.default.createElement("span",null,"回复：",i)))),s.default.createElement("div",{className:M.default.content,dangerouslySetInnerHTML:{__html:l}}),s.default.createElement("h4",{className:M.default.reliesNumber},"共",i,"条回复："),s.default.createElement(y.default,{replies:c,getTopicData:this.getTopicData}),s.default.createElement("div",{className:M.default.bottom},_?s.default.createElement(v.default,{getTopicData:this.getTopicData}):s.default.createElement(E.default,null))))),s.default.createElement(T.default,null))}}]),t}(u.Component),F=function(e){return{topicData:e.topicState.topicData}},J=function(e){return{renderTopic:function(t){e(m.getTopic(t))}}};t.default=(0,f.connect)(F,J)(L)},365:function(e,t){"use strict";function n(e){return{type:"TOPIC_DETAIL",topicData:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getTopic=n},366:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),u=a(c),s=n(367),f=a(s),p=n(373),d=a(p),m=n(296),_=a(m),h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.replies,n=e.getTopicData;return u.default.createElement("ul",{className:d.default.commentList},u.default.createElement(_.default,{transitionName:"fade-slide",transitionEnterTimeout:500,transitionLeaveTimeout:500},t.map(function(e,t){return u.default.createElement(f.default,{data:e,key:t,getTopicData:n})})))}}]),t}(c.Component);t.default=h},367:function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(1),s=r(u),f=n(225),p=n(291),d=a(p),m=n(368),_=r(m),h=n(370),b=r(h),y=n(309),g=r(y),v="https://cnodejs.org/api/v1/",w=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showRelyForm:!1,ups:0,upsClassName:null},n.handleRelyClick=n.handleRelyClick.bind(n),n.handleUpsClick=n.handleUpsClick.bind(n),n}return l(t,e),c(t,[{key:"handleRelyClick",value:function(){this.setState({showRelyForm:!this.state.showRelyForm})}},{key:"handleUpsClick",value:function(){var e=this,t=localStorage.getItem("accesstoken"),n=this.props.data.id;t?g.default.post(v+"reply/"+n+"/ups",{accesstoken:t}).then(function(t){var n=t.data.action;"up"===n&&e.setState({ups:e.state.ups+1,upsClassName:"active"}),"down"===n&&e.setState({ups:e.state.ups-1,upsClassName:null})}):f.hashHistory.push("/cnode-react/login")}},{key:"componentWillMount",value:function(){var e=this.props.data.ups;this.setState({ups:e.length})}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.getTopicData,a=t.content,r=t.author,o=r.loginname,i=r.avatar_url,l=t.create_at,c=t.id;return s.default.createElement("li",{className:_.default.comment},s.default.createElement("div",{className:_.default.msg},s.default.createElement(f.Link,{to:"/user/"+o},s.default.createElement("img",{src:i,className:_.default.avatar})),s.default.createElement("div",{className:_.default.msgDetail},s.default.createElement("span",null,s.default.createElement(f.Link,{to:"/user/"+o},o)),s.default.createElement("span",null,"回复于",d.formatTime(l)))),s.default.createElement("div",{dangerouslySetInnerHTML:{__html:a}}),s.default.createElement("div",{className:_.default.oper},s.default.createElement("span",{className:_.default.dianzan},s.default.createElement("i",{className:"iconfont icon-dianzan "+_.default[this.state.upsClassName],onClick:this.handleUpsClick}),this.state.ups),s.default.createElement("i",{className:"iconfont icon-reply "+_.default.reply,onClick:this.handleRelyClick})),s.default.createElement("div",{className:_.default.relyFormContainer},this.state.showRelyForm?s.default.createElement(b.default,{relyId:c,loginname:o,handleRelyClick:this.handleRelyClick,getTopicData:n}):null))}}]),t}(u.Component);t.default=w},368:function(e,t,n){var a=n(369);"string"==typeof a&&(a=[[e.id,a,""]]);n(283)(a,{});a.locals&&(e.exports=a.locals)},369:function(e,t,n){t=e.exports=n(282)(),t.push([e.id,".comment__comment-ylyRJ{padding:.1rem;overflow:hidden;border-bottom:1px solid #ddd}.comment__avatar-1btat{width:.4rem;height:.4rem;border-radius:50%;margin-right:.1rem}.comment__msg-3i9_Z{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment__msg-3i9_Z span{display:block}.comment__relyFormContainer-3aBnv{margin-top:.1rem}.comment__oper-1CdK2{text-align:right}.comment__dianzan-ta3Al{margin-right:.2rem}.comment__active-324-W{color:blue}.comment__reply-83cNn{vertical-align:middle}",""]),t.locals={comment:"comment__comment-ylyRJ",avatar:"comment__avatar-1btat",msg:"comment__msg-3i9_Z",relyFormContainer:"comment__relyFormContainer-3aBnv",oper:"comment__oper-1CdK2",dianzan:"comment__dianzan-ta3Al",active:"comment__active-324-W",reply:"comment__reply-83cNn"}},370:function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(1),s=r(u),f=n(178),p=n(371),d=r(p),m=n(365),_=a(m),h=n(309),b=r(h),y="https://cnodejs.org/api/v1/",g=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=n.handleSubmit.bind(n),n}return l(t,e),c(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.props,n=t.relyId,a=t.topicId,r=t.loginname,o=t.handleRelyClick,i=t.getTopicData,l=t.renderTopic;if(!this.text.value.trim())return void alert("回复的内容不能为空！");var c="[——来自吴小粥的cnode-react手机版](https://wuxiaozhou.coding.me/cnode-react/)",u=n?"[@"+r+"](/user/"+r+") "+this.text.value+" "+c:this.text.value+" "+c,s=localStorage.getItem("accesstoken");b.default.post(y+"topic/"+a+"/replies",{accesstoken:s,reply_id:n,content:u}).then(function(){alert("回复成功！"),i(l,a),this.text.value=null}).catch(function(e){alert("回复失败！！！"),console.log(e),alert(e)}),o&&o()}},{key:"render",value:function(){var e=this;return s.default.createElement("form",{className:d.default.form,onSubmit:this.handleSubmit},s.default.createElement("textarea",{rows:"7",placeholder:"支持markdown语法",ref:function(t){e.text=t},className:d.default.text}),s.default.createElement("button",{type:"submit",className:d.default.button},"回复"))}}]),t}(u.Component),v=function(e){return{topicId:e.topicState.topicData.id}},w=function(e){return{renderTopic:function(t){e(_.getTopic(t))}}};t.default=(0,f.connect)(v,w)(g)},371:function(e,t,n){var a=n(372);"string"==typeof a&&(a=[[e.id,a,""]]);n(283)(a,{});a.locals&&(e.exports=a.locals)},372:function(e,t,n){t=e.exports=n(282)(),t.push([e.id,".commentForm__form-11-wT{overflow:hidden}.commentForm__text-xu42t{width:100%;resize:none;border-radius:.05rem;box-sizing:border-box}.commentForm__button-LrKDd{display:block;width:100%;border-radius:.05rem;margin-top:.2rem;padding:.1rem .2rem}",""]),t.locals={form:"commentForm__form-11-wT",text:"commentForm__text-xu42t",button:"commentForm__button-LrKDd"}},373:function(e,t,n){var a=n(374);"string"==typeof a&&(a=[[e.id,a,""]]);n(283)(a,{});a.locals&&(e.exports=a.locals)},374:function(e,t,n){t=e.exports=n(282)(),t.push([e.id,".topic__topicContainer-3dImr{margin-top:.4rem;padding:.1rem}.topic__headerContainer-QKGjE{width:100%;position:fixed;top:0;left:0}.topic__topic-IUSGc{overflow:auto;white-space:pre-wrap;word-wrap:break-word}.topic__title-d9lRP{line-height:.3rem}.topic__msg-1-QRP{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.topic__pic-2ur9B{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;margin-right:.1rem}.topic__avatar-16rgP{width:.4rem;height:.4rem;border-radius:50%}.topic__msgDetail-Kuyr-{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.topic__reliesNumber-1J2Q7{line-height:.3rem;border-left:.05rem solid #333;background-color:#ddd;padding-left:.2rem}.topic__bottom-1IIZ5{margin-top:.2rem;margin-bottom:.2rem}",""]),t.locals={topicContainer:"topic__topicContainer-3dImr",headerContainer:"topic__headerContainer-QKGjE",topic:"topic__topic-IUSGc",title:"topic__title-d9lRP",msg:"topic__msg-1-QRP",pic:"topic__pic-2ur9B",avatar:"topic__avatar-16rgP",msgDetail:"topic__msgDetail-Kuyr-",reliesNumber:"topic__reliesNumber-1J2Q7",bottom:"topic__bottom-1IIZ5"}}});